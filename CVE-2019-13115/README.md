# CVE-2019-13115

## About
* <https://nvd.nist.gov/vuln/detail/CVE-2019-13115>

## Details

The source location of the vulnerability is due to an incorrectly implemented bounds checking function:
 
 ```c
 int _libssh2_check_length(struct string_buf *buf, size_t len) {
     return ((int) (buf->dataptr - buf->data) <= (int) (buf->len - len)) ? 1 : 0;
 }
 ```

The PoC works by making `len` greater than `buf->len + 0x80000000` so that the calculation of `(int)(buf->len - len)` overflows and becomes a very large positive number, thereby bypassing the bounds check and causing libssh2 to crash with a segmentation fault. 

## PoC / Exploit

* <https://github.com/kevinbackhouse/security-lab/tree/master/SecurityExploits/libssh2/out_of_bounds_read_kex_CVE-2019-13115> 


## Environment used

* Ubuntu 18.04.3 LTS


## Reproduction
* Terminal 1
```bash
bash server.sh
```
* Terminal 2
```bash
bash client.sh
cd ~/libssh2/example && ./ssh2 172.18.0.10 hal x
```
<br>
The result should be a message with <i>"Segmentation fault"</i>.
