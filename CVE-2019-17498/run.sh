#!/bin/bash
sudo apt-get update && sudo apt-get install -y git gcc build-essential autoconf automake libtool g++
cd /tmp || exit
if [ ! -d libssh2 ]; then
  git clone https://github.com/libssh2/libssh2.git
fi
if [ -d libssh2 ]; then
  cd libssh2 || exit
  git checkout 42d37aa63129a1b2644bf6495198923534322d64
  sudo ./buildconf
  sudo libtoolize && sudo ./buildconf
  ./configure && make -j
  sed -i "113 s/22/8022/1" example/ssh2.c
  make -j
  /tmp/libssh2/example/ssh2 172.168.1.83 guest qwerty
fi