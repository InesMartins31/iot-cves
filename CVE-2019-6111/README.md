# CVE-2019-6110 / CVE-2019-6111

## About
<https://nvd.nist.gov/vuln/detail/CVE-2019-6110> <br/>
<https://nvd.nist.gov/vuln/detail/CVE-2019-6111>


## PoC / Exploit

* <https://www.exploit-db.com/exploits/46193/> 
* <https://gist.github.com/mehaase/63e45c17bdbbd59e8e68d02ec58f4ca2>


## Environment used

* Ubuntu 18.04.3 LTS
* OpenSSH 7.6-7.9
* [Docker image](https://drive.google.com/open?id=1NNK8CW7yKsM96LTY0zAap7V4oqisJdGi)

## Requirements
```bash
docker load -i docker-image.tar.gz
docker run -it scp_tested:latest  
```

## Reproduction
* Terminal 1
```bash 
python3 exploit.py
```
* Terminal 2 (docker)
```bash
ssh-keygen -f "~/.ssh/known_hosts" -R "{IP}"
scp -P 5555 {USER}@{IP}:{FILE} .
ls -a
```
The result of `ls -a` will show the file requested FILE with his content adulterated and another called `exploit.txt`.

## Links
* [OpenSSL versions](https://www.openssl.org/source/) 
* [Tutorial SSL source compilation](https://askubuntu.com/a/463317)
* [OpenSSH old versions](https://ftp.rnl.tecnico.ulisboa.pt/pub/OpenBSD/OpenSSH/portable)
* [Tutorial SSH source compilation](https://www.tecmint.com/install-openssh-server-from-source-in-linux/)
* [Release with patch](https://www.openssh.com/txt/release-8.0)
