FROM ubuntu:18.04
ARG DEBIAN_FRONTEND=noninteractive
RUN apt-get update && apt-get install -y netcat wget
WORKDIR /home
RUN wget https://raw.githubusercontent.com/kevinbackhouse/security-lab/master/SecurityExploits/libssh2/out_of_bounds_read_disconnect_CVE-2019-17498/server/home/poc.bin
RUN echo "root:qwerty" | chpasswd
RUN useradd guest -s /bin/bash && \
    mkdir -p /home/guest/.ssh && \
    chown -R guest:guest /home/guest/ && \
    echo "guest:guest" | chpasswd
CMD nc -lp 22 </home/poc.bin
