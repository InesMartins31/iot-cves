#!/bin/bash

sudo apt update

# Dependencies
sudo apt-get install libnet-ssleay-perl libauthen-pam-perl libio-pty-perl python apt-show-versions -y
sudo apt-get --fix-broken install -f -y

# Webmin 1.90
wget https://netcologne.dl.sourceforge.net/project/webadmin/webmin/1.900/webmin_1.900_all.deb
sudo dpkg -i webmin_1.900_all.deb
sudo apt --fix-broken install -y

sudo /usr/share/webmin/changepass.pl /etc/webmin root admin
sudo sed --in-place s/passwd_mode=.*/passwd_mode=2/1 /etc/webmin/miniserv.conf

# sed s/referers_none.*/referers_none=0/1 /etc/webmin/config >tmp.txt && sudo mv tmp.txt /etc/webmin/config
# sed 's/2/VI/1' /usr/share/webmin/password_change.cgi >tmp.txt && sudo mv tmp.txt /usr/share/webmin/password_change.cgi

sudo /etc/webmin/restart