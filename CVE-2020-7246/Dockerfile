FROM ubuntu:18.04
ENV DEBIAN_FRONTEND=noninteractive
RUN apt-get update
RUN apt-get upgrade -y
RUN apt-get install -y wget apache2 php php-mysqlnd mysql-server zip php-xml
RUN sed -i 's/127.0.0.1/0.0.0.0/g' /etc/mysql/mysql.conf.d/mysqld.cnf
RUN service mysql start &&\
    mysql -u root -e "CREATE USER 'teste'@'%' IDENTIFIED BY 'teste';GRANT ALL PRIVILEGES ON * . * TO 'teste'@'%';FLUSH PRIVILEGES;" &&\
    mysql -u root -e "CREATE DATABASE qdpm" &&\
    mysql -u root -e "USE mysql;UPDATE user SET plugin='mysql_native_password' WHERE User='root';FLUSH PRIVILEGES;"
RUN wget https://netix.dl.sourceforge.net/project/qdpm/qdPM_9.1.zip
RUN rm /var/www/html/index.html
RUN unzip qdPM_9.1.zip -d /var/www/html
RUN chown www-data -R /var/www/
RUN chmod 777  -R /var/www/
EXPOSE 80 3306
CMD service apache2 start && service mysql start &&/bin/bash
